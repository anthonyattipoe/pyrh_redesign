Refactor endpoints to ursl and make better use of yarl.
